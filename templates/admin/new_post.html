{{ define "content" }}
<div class="w-full max-w-5xl mx-auto bg-white p-10 rounded-lg shadow-lg">
    <!-- Header -->
    <header class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800">Create New Post</h1>
    </header>

    <form action="/admin/posts" method="POST" enctype="multipart/form-data" class="space-y-8">
        <!-- Title -->
        <div class="form-control w-full">
            <label class="label" for="title">
                <span class="label-text font-semibold">Title</span>
            </label>
            <input type="text" id="title" name="title" required class="input input-bordered input-lg w-full bg-white">
        </div>

        <!-- Content -->
        <div class="form-control w-full">
            <label class="label" for="content">
                <span class="label-text font-semibold">Content</span>
            </label>
            <textarea id="content" name="content" rows="16" class="textarea textarea-bordered textarea-lg w-full bg-white"></textarea>
        </div>

        <!-- Tags -->
        <div class="form-control w-full">
            <label class="label" for="tags">
                <span class="label-text font-semibold">Tags</span>
            </label>
            <div class="dropdown w-full">
                <input type="text" placeholder="Select tags..." id="tagInput" class="input input-bordered input-lg w-full cursor-pointer bg-white" readonly onclick="toggleDropdown()">
                <ul id="tagDropdown" class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-full hidden max-h-60 overflow-y-auto">
                    {{ range .AllTags }}
                    <li>
                        <label class="cursor-pointer flex items-center gap-2">
                            <input type="checkbox" name="tags" value="{{ .Name }}" class="checkbox checkbox-primary">
                            {{ .Name }}
                        </label>
                    </li>
                    {{ end }}
                </ul>
            </div>
            <small class="text-gray-500 mt-1 block">Select multiple tags</small>
        </div>

        <!-- Image -->
        <div class="form-control w-full">
            <label class="label" for="image">
                <span class="label-text font-semibold">Image</span>
            </label>
            <input type="file" id="image" name="image" class="file-input file-input-bordered file-input-lg w-full bg-white">
        </div>

        <!-- Actions -->
        <div class="flex justify-end gap-4">
            <a href="/admin/posts" class="btn btn-outline btn-secondary btn-lg">Cancel</a>
            <button type="submit" class="btn btn-primary btn-lg">Save Post</button>
        </div>
    </form>
</div>

<script>
    const tagInput = document.getElementById('tagInput');
    const tagDropdown = document.getElementById('tagDropdown');

    function toggleDropdown() {
        tagDropdown.classList.toggle('hidden');
    }

    const checkboxes = tagDropdown.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(cb => {
        cb.addEventListener('change', () => {
            const selected = Array.from(checkboxes)
                .filter(chk => chk.checked)
                .map(chk => chk.value)
                .join(', ');
            tagInput.value = selected;
        });
    });

    document.addEventListener('click', (e) => {
        if (!tagDropdown.contains(e.target) && e.target !== tagInput) {
            tagDropdown.classList.add('hidden');
        }
    });
</script>
{{ end }}
